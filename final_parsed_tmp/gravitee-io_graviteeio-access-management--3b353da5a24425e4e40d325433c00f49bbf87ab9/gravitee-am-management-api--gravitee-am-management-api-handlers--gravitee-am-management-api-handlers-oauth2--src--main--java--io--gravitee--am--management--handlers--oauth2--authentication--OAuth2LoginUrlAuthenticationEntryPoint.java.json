[
    {
        "rev_path": "gravitee-am-management-api/gravitee-am-management-api-handlers/gravitee-am-management-api-handlers-oauth2/src/main/java/io/gravitee/am/management/handlers/oauth2/authentication/OAuth2LoginUrlAuthenticationEntryPoint.java",
        "definition": "public class OAuth2LoginUrlAuthenticationEntryPoint extends LoginUrlAuthenticationEntryPoint {\n\n    public OAuth2LoginUrlAuthenticationEntryPoint(String loginFormUrl) {\n        super(loginFormUrl);\n    }\n\n    @Override\n    protected String determineUrlToUseForThisRequest(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) {\n        String url = super.determineUrlToUseForThisRequest(request, response, exception);\n        return UriComponentsBuilder.fromPath(url).queryParam(\"client_id\", request.getParameter(\"client_id\")).toUriString();\n    }\n\n    @Override\n    protected String buildRedirectUrlToLoginPage(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) {\n        String url = super.buildRedirectUrlToLoginPage(request, response, authException);\n\n        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);\n\n        String scheme = request.getHeader(HttpHeaders.X_FORWARDED_PROTO);\n        if (scheme != null && !scheme.isEmpty()) {\n            builder.scheme(scheme);\n        }\n\n        String host = request.getHeader(HttpHeaders.X_FORWARDED_HOST);\n        if (host != null && !host.isEmpty()) {\n            if (host.contains(\":\")) {\n                // Forwarded host contains both host and port\n                String [] parts = host.split(\":\");\n                builder.host(parts[0]);\n                builder.port(parts[1]);\n            } else {\n                builder.host(host);\n            }\n        }\n\n        return builder.toUriString();\n    }\n}",
        "package": "package io.gravitee.am.management.handlers.oauth2.authentication;",
        "tree_path": "OAuth2LoginUrlAuthenticationEntryPoint",
        "name": "OAuth2LoginUrlAuthenticationEntryPoint",
        "modifiers": "public",
        "superclass": "extends LoginUrlAuthenticationEntryPoint",
        "super_interfaces": null,
        "body": "{\n\n    public OAuth2LoginUrlAuthenticationEntryPoint(String loginFormUrl) {\n        super(loginFormUrl);\n    }\n\n    @Override\n    protected String determineUrlToUseForThisRequest(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) {\n        String url = super.determineUrlToUseForThisRequest(request, response, exception);\n        return UriComponentsBuilder.fromPath(url).queryParam(\"client_id\", request.getParameter(\"client_id\")).toUriString();\n    }\n\n    @Override\n    protected String buildRedirectUrlToLoginPage(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) {\n        String url = super.buildRedirectUrlToLoginPage(request, response, authException);\n\n        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);\n\n        String scheme = request.getHeader(HttpHeaders.X_FORWARDED_PROTO);\n        if (scheme != null && !scheme.isEmpty()) {\n            builder.scheme(scheme);\n        }\n\n        String host = request.getHeader(HttpHeaders.X_FORWARDED_HOST);\n        if (host != null && !host.isEmpty()) {\n            if (host.contains(\":\")) {\n                // Forwarded host contains both host and port\n                String [] parts = host.split(\":\");\n                builder.host(parts[0]);\n                builder.port(parts[1]);\n            } else {\n                builder.host(host);\n            }\n        }\n\n        return builder.toUriString();\n    }\n}",
        "start_point": {
            "row": 29,
            "column": 0
        },
        "end_point": {
            "row": 66,
            "column": 1
        },
        "file_mode": "Renamed-Modified",
        "map_path": "gravitee-am-management-api/gravitee-am-management-api-handlers/gravitee-am-management-api-handlers-admin/src/main/java/io/gravitee/am/management/handlers/admin/authentication/LoginUrlAuthenticationEntryPoint.java",
        "methods": [
            {
                "definition": "public OAuth2LoginUrlAuthenticationEntryPoint(String loginFormUrl) {\n    super(loginFormUrl);\n}",
                "name": "OAuth2LoginUrlAuthenticationEntryPoint",
                "modifiers": "public",
                "parameters": [
                    {
                        "type": "String",
                        "name": "loginFormUrl"
                    }
                ],
                "body": "{\n    super(loginFormUrl);\n}",
                "constructor": true,
                "start_point": {
                    "row": 31,
                    "column": 4
                },
                "end_point": {
                    "row": 33,
                    "column": 5
                }
            },
            {
                "definition": "@Override\nprotected String determineUrlToUseForThisRequest(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) {\n    String url = super.determineUrlToUseForThisRequest(request, response, exception);\n    return UriComponentsBuilder.fromPath(url).queryParam(\"client_id\", request.getParameter(\"client_id\")).toUriString();\n}",
                "name": "determineUrlToUseForThisRequest",
                "modifiers": "@Override\n    protected",
                "return_type": "String",
                "parameters": [
                    {
                        "type": "HttpServletRequest",
                        "name": "request"
                    },
                    {
                        "type": "HttpServletResponse",
                        "name": "response"
                    },
                    {
                        "type": "AuthenticationException",
                        "name": "exception"
                    }
                ],
                "body": "{\n    String url = super.determineUrlToUseForThisRequest(request, response, exception);\n    return UriComponentsBuilder.fromPath(url).queryParam(\"client_id\", request.getParameter(\"client_id\")).toUriString();\n}",
                "start_point": {
                    "row": 35,
                    "column": 4
                },
                "end_point": {
                    "row": 39,
                    "column": 5
                }
            },
            {
                "definition": "@Override\nprotected String buildRedirectUrlToLoginPage(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) {\n    String url = super.buildRedirectUrlToLoginPage(request, response, authException);\n\n    UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);\n\n    String scheme = request.getHeader(HttpHeaders.X_FORWARDED_PROTO);\n    if (scheme != null && !scheme.isEmpty()) {\n        builder.scheme(scheme);\n    }\n\n    String host = request.getHeader(HttpHeaders.X_FORWARDED_HOST);\n    if (host != null && !host.isEmpty()) {\n        if (host.contains(\":\")) {\n            // Forwarded host contains both host and port\n            String [] parts = host.split(\":\");\n            builder.host(parts[0]);\n            builder.port(parts[1]);\n        } else {\n            builder.host(host);\n        }\n    }\n\n    return builder.toUriString();\n}",
                "name": "buildRedirectUrlToLoginPage",
                "modifiers": "@Override\n    protected",
                "return_type": "String",
                "parameters": [
                    {
                        "type": "HttpServletRequest",
                        "name": "request"
                    },
                    {
                        "type": "HttpServletResponse",
                        "name": "response"
                    },
                    {
                        "type": "AuthenticationException",
                        "name": "authException"
                    }
                ],
                "body": "{\n    String url = super.buildRedirectUrlToLoginPage(request, response, authException);\n\n    UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);\n\n    String scheme = request.getHeader(HttpHeaders.X_FORWARDED_PROTO);\n    if (scheme != null && !scheme.isEmpty()) {\n        builder.scheme(scheme);\n    }\n\n    String host = request.getHeader(HttpHeaders.X_FORWARDED_HOST);\n    if (host != null && !host.isEmpty()) {\n        if (host.contains(\":\")) {\n            // Forwarded host contains both host and port\n            String [] parts = host.split(\":\");\n            builder.host(parts[0]);\n            builder.port(parts[1]);\n        } else {\n            builder.host(host);\n        }\n    }\n\n    return builder.toUriString();\n}",
                "start_point": {
                    "row": 41,
                    "column": 4
                },
                "end_point": {
                    "row": 65,
                    "column": 5
                }
            }
        ]
    }
]